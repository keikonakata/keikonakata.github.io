<!doctype html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title> Keiko Nakata - Valgrind</title>
  <link href="../css/default.css" type="text/css" rel="stylesheet" />
</head>
<body>
        <header>
            <nav>
                <a href="../index.html">Home</a>
                <a href="../archive.html">Archive</a>
            </nav>
        </header>

        <main role="main">
            <article>
    <section class="header">
        <h1>Valgrind</h1>
        Updated on 2022-05-07
        
    </section>
    <section>
        <h4 id="citations">Citations</h4>
<p><a href="https://valgrind.org/">Homepage</a></p>
<p><a href="https://kcachegrind.github.io/html/Home.html">KCachegrind</a></p>
<p><a href="https://sourceware.org/binutils/docs/gprof/">GNU gprof</a></p>
<p><a href="https://web.stanford.edu/class/archive/cs/cs107/cs107.1222/resources/callgrind">Valgrind Callgrind</a></p>
<p><a href="https://accu.org/journals/overload/20/108/floyd_1930/">Valgrind Part 1 - Introduction by Paul Floyd</a></p>
<p>Valgrind runs the application under the test (AUT) in a virtual machine, VEX. VEX performs on the fly translation of the AUT machine code to an Intermediate Representation (IR), and intercepts system calls and memory accesses required for the analysis.</p>
<p>cachegrind simulates caches and counts cache misses/hits. callgrind counts CPU instructions executed.</p>
<p>Run <code>callgrind</code></p>
<pre><code>valgrind --tool=callgrind --collect-atstart=no program-to-run program-arguments</code></pre>
<p>Run the annotator</p>
<pre><code>callgrind_annotate --show=DLmr --sort=DLmr --auto=yes callgrind.out.pid</code></pre>
<p><code>--auto=yes</code> breaks down the results per statement (instead of per function). <code>--show=DLmr</code> only shows figures for DLmr</p>
<p>Enable cache simulation</p>
<pre><code>valgrind --tool=callgrind --simulate-cache=yes program-to-run program-arguments</code></pre>
<h3 id="how-to-limit-the-range-of-collected-events">How to limit the range of collected events</h3>
<p><a href="https://valgrind.org/docs/manual/cl-manual.html#cl-manual.limits">Limiting the range of collected events</a></p>
<p>the collection state at program start can be switched off by –instr-atstart=no. During execution, it can be controlled programmatically with the macro CALLGRIND_TOGGLE_COLLECT;. Further, you can limit event collection to a specific function by using –toggle-collect=function.</p>
<p>I – instruction <code>Ir</code> – instruction reads, #-instructions x #-frequency I1 – instruction L1 LLi – Last-Level instruction</p>
<p>D data D1 - data L1 cache LLd – last level cache data</p>
<p>Bc – conditional branches executed Bi – indirect branches executed</p>
<p>By default, the counts are exclusive— the counts for a function include only the time spent in that function and not in the functions that it calls.</p>
<p><code>--inclusive=yes</code> makes the counts inclusive.</p>
<p>L1 miss will typically cost around 5-10 cycles, an L2 miss can cost as much as 100-200 cycles,</p>
    </section>
</article>

        </main>

        <footer>
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>
        </footer>
    </body>
</html>
